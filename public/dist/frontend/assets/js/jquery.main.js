jQuery(function(){initNavigationSelect();jcf.customForms.replaceAll();initTouchNav();initAccordion();initPopups();initInputs();initFitVids();initDropDownClasses();initPlayer();initAjaxBlocksLoad();initFixedBar();initLightbox();initAnchorGigs();initLayout();initQuicksand();initNewsLetter();initContactForm();initFacebookLikebox();initTwitter();initNiceScroll();initCustomizer();});jQuery(window).load(function(){setTimeout(function(){initSameHeight();jQuery(window).trigger('resize');},200);initSliderRevolution();});function initCustomizer(){$.getScript('customizer/js/init.js');}
function initAnchorGigs(){jQuery('ul.concerts-list .open-link').each(function(){var opener=jQuery(this);if(window.location.href.indexOf(opener.attr('id'))>0){jQuery(window).scrollTop(opener.offset().top-100);opener.trigger('click');}})
var links=jQuery('.concert-box');links.each(function(){var link=jQuery(this);var target='#'+link.attr('data-rel');link.bind('click',function(e){e.preventDefault();window.location.href=link.attr('href')+'#targetGig='+target})})}
function initLayout(){var visibleElements;ResponsiveHelper.addRange({'..767':{on:function(){visibleElements=1;initCarousel(visibleElements,true)
initCarousel(visibleElements,false);},off:function(){initCarousel(visibleElements,true)}},'768..':{on:function(){visibleElements=3;initCarousel(visibleElements,true)
initCarousel(visibleElements,false);},off:function(){initCarousel(visibleElements,true)}}});}
function initSliderRevolution(){var api;jQuery(document).ready(function(){api=jQuery('.gallery .mask').revolution({delay:5000,startheight:500,startwidth:960,hideThumbs:300,thumbWidth:100,thumbHeight:50,thumbAmount:5,navigationType:"none",navigationArrows:"none",navigationStyle:"square",navigationHAlign:"center",navigationVAlign:"bottom",navigationHOffset:0,navigationVOffset:20,soloArrowLeftHalign:"left",soloArrowLeftValign:"center",soloArrowLeftHOffset:20,soloArrowLeftVOffset:0,soloArrowRightHalign:"right",soloArrowRightValign:"center",soloArrowRightHOffset:20,soloArrowRightVOffset:0,touchenabled:"on",onHoverStop:"on",stopAtSlide:-1,stopAfterLoops:-1,shadow:1,fullWidth:"off"});api.bind("revolution.slide.onloaded",function(e){jQuery('.gallery').css('height','inherit');});});}
function initFacebookLikebox(){if($('#fb-likebox').length==0)
return false;var fb_app_id=$('#fb-likebox').data('appid');var fb_page_url=$('#fb-likebox').data('pageurl');fb_page_url=encodeURI(fb_page_url);var iframe='<iframe src="//www.facebook.com/plugins/likebox.php?href='+fb_page_url+'&amp;width=200&amp;height=62&amp;show_faces=false&amp;colorscheme=dark&amp;stream=false&amp;border_color&amp;header=false&amp;appId='+fb_app_id+'" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:200px; height:62px;" allowTransparency="true"></iframe>';$('#fb-likebox').html(iframe);}
function initTwitter(){if($('#twitter').length==0)
return false;var username=$('#twitter').data('username');jQuery(function($){$("#twitter").tweet({modpath:'./js/twitter/',join_text:"auto",username:(username?username:'envato'),count:1,auto_join_text_default:" we said, ",auto_join_text_ed:" we ",auto_join_text_ing:" we were ",auto_join_text_reply:" we replied ",auto_join_text_url:" we were checking out ",loading_text:"loading tweets..."}).bind("loaded",function(){jQuery(window).resize();});});}
function initNiceScroll(){$(document).ready(function(){$("html").niceScroll();});}
function initCarousel(visibleElements,destroy){jQuery('.carousel').each(function(){var set=jQuery(this);if(destroy){set.find('.slideset').trigger('destroy')}
else{var slider=set.find('.slideset').carouFredSel({circular:true,responsive:true,width:'100%',scroll:1,auto:false,prev:{button:set.find('.btn-prev')},next:{button:set.find('.btn-next')},items:{visible:visibleElements,height:'variable'}});}});}
function initFixedBar(){var win=jQuery(window);var animSpeed=500;var activeClass='fixed-bar';var clone;jQuery('.panel').each(function(){var panel=jQuery(this);function getPosition(){var offset=jQuery('#header').outerHeight(true);if(win.scrollTop()>offset){if(!clone){clone=true;panelHeight=panel.outerHeight();clone=panel.clone();clone.insertAfter(panel).addClass(activeClass).css({'opacity':0,'marginTop':-panelHeight}).animate({'opacity':1,'marginTop':0},{duration:animSpeed,queue:false});}}
else{if(clone){clone.remove();clone=false;}}}
getPosition();win.bind('scroll resize',getPosition);})}
function initAjaxBlocksLoad(){var openers=jQuery('a.button-more');openers.each(function(){if(jQuery(this).attr('data-rel')){var opener=jQuery(this);var container=jQuery('#'+opener.attr('data-rel'));var src=opener.attr('href');var loadingClass='ajax-load';var ajaxBusy,loadedPopup;if(container.length){opener.bind('click',function(e){e.preventDefault();if(src!=='#'){if(!ajaxBusy){ajaxBusy=true;container.addClass(loadingClass);ajaxBusy=true;jQuery.ajax({url:src,type:'get',dataType:'text',success:function(msg){var loadedPopup=jQuery('<div/>').html(msg).hide().appendTo(container).fadeIn(function(){loadedPopup.find('li:eq(0)').unwrap();});if(loadedPopup.find('.button-more').length){src=loadedPopup.find('.button-more').attr('href');loadedPopup.find('.button-more').remove();ajaxBusy=false;}
else{ajaxBusy=true;opener.remove();}
initTouchNav();},error:function(){alert('AJAX Error!');}});container.removeClass(loadingClass);};};});};};});}
function initDropDownClasses(){jQuery('#nav li').each(function(){var item=jQuery(this);var drop=item.find('ul');var link=item.find('a').eq(0);if(drop.length){item.addClass('has-drop-down');if(link.length)link.addClass('has-drop-down-a');}});}
function initPlayer(){jQuery('.player-holder').each(function(ind){var set=jQuery(this);var dataUrl=set.attr('data-url-playlist');var posterImage=set.find('.poster-image');var defURl=posterImage.attr('src');var titleBox=set.find('.player-title-box');var player=set.find('.jp-jplayer');var playerBox=set.find('.player-box');var uiPlayer='jplayer-custom-'+new Date().getMilliseconds()+ind;var uiPlayerBox='jplayerBox-custom-'+new Date().getMilliseconds()+ind;player.attr('id',uiPlayer);playerBox.attr('id',uiPlayerBox);var pl;jQuery.ajax({url:dataUrl,type:'get',dataType:'script',success:function(msg){startPlayer();}});function startPlayer(){pl=new jPlayerPlaylist({jPlayer:"#"+uiPlayer,cssSelectorAncestor:"#"+uiPlayerBox},mucisPlayList,{swfPath:"js",supplied:"mp3",wmode:"window",ready:function(){refreshInfo();},play:function(){refreshInfo();}});}
function refreshInfo(){if(pl.original[pl.current].poster){posterImage.attr('src',pl.original[pl.current].poster);}
else{posterImage.attr('src',defURl);};if(pl.original[pl.current].title){titleBox.html(pl.original[pl.current].title)}}});jQuery('.tracks-list li').each(function(ind){var set=jQuery(this);var player=set.find('.jp-jplayer');var playerBox=set.find('.player-box');var playBtn=set.find('.buttons .btn-play');var pauseBtn=set.find('.buttons .btn-pause');var urlMedia=set.attr('data-media');var uiPlayer='jplayer-custom-'+new Date().getMilliseconds()+ind;var uiPlayerBox='jplayerBox-custom-'+new Date().getMilliseconds()+ind;player.attr('id',uiPlayer);playerBox.attr('id',uiPlayerBox);if(urlMedia){var urlTag=urlMedia.substr(urlMedia.lastIndexOf('.')+1)
var obj={};obj[urlTag]=urlMedia;jQuery("#"+uiPlayer).jPlayer({cssSelectorAncestor:"#"+uiPlayerBox,ready:function(event){jQuery(this).jPlayer("setMedia",obj);},swfPath:"js",supplied:urlTag,wmode:"window"});var allPauseBtns=jQuery('.tracks-list li').not(set).find('.buttons .btn-pause');playBtn.click(function(){allPauseBtns.click();});}})}
function initDropDownClasses(){jQuery('#nav li').each(function(){var item=jQuery(this);var drop=item.find('ul');var link=item.find('a').eq(0);if(drop.length){item.addClass('has-drop-down');if(link.length)link.addClass('has-drop-down-a');}});}
function initFitVids(){jQuery('.video-block').fitVids();}
function initAccordion(){jQuery('.concerts-list').slideAccordion({activeClass:'expanded',opener:'a.open-link',slider:'div.slide',animSpeed:300});}
function initPopups(){jQuery('.panel').contentPopup({mode:'click',popup:'.nav-holder',btnOpen:'.opener'});}
function initInputs(){PlaceholderInput.replaceByOptions({clearInputs:true,clearTextareas:true,clearPasswords:true,skipClass:'default',wrapWithElement:false,showUntilTyping:false,getParentByClass:false,placeholderAttr:'value'});}
function initSameHeight(){jQuery('.widget-blocks').sameHeight({elements:'.holder',flexible:true,multiLine:true});jQuery('.carousel').sameHeight({elements:'.concert-box, .text, .video-box',flexible:true,multiLine:true});jQuery('.articles-section').sameHeight({elements:'.text, .block a',flexible:true,multiLine:true});}
function initTouchNav(){lib.each(lib.queryElementsBySelector('#nav'),function(){new TouchNav({navBlock:this});});lib.each(lib.queryElementsBySelector('.articles-section .article'),function(){new TouchNav({navBlock:this,menuItems:'div',menuOpener:'a',menuDrop:''});});lib.each(lib.queryElementsBySelector('.concerts-list li'),function(){new TouchNav({navBlock:this,menuItems:'div.title-row',menuOpener:'a',menuDrop:''});});lib.each(lib.queryElementsBySelector('.listing-section'),function(){new TouchNav({navBlock:this,menuItems:'a',menuOpener:'a',menuDrop:''});});lib.each(lib.queryElementsBySelector('.carousel'),function(){new TouchNav({navBlock:this,menuItems:'a',menuOpener:'a',menuDrop:''});});lib.each(lib.queryElementsBySelector('.carousel'),function(){new TouchNav({navBlock:this,menuItems:'a',menuOpener:'a',menuDrop:'div.hover-box'});});lib.each(lib.queryElementsBySelector('.article'),function(){new TouchNav({navBlock:this,menuItems:'a',menuOpener:'a',menuDrop:''});});lib.each(lib.queryElementsBySelector('.photos-list'),function(){new TouchNav({navBlock:this,menuItems:'li',menuOpener:'a',menuDrop:'span.hover-text'});});}
function initNavigationSelect(){jQuery('.filters-block .holder ul').navigationSelect({defaultOptionAttr:'title',useDefaultOption:false});}
function initQuicksand(){var $gallery=$('.quicksand');if($gallery.length==0)
return-1;var $data=$gallery.clone();var $defaultFilter=$('.quicksand-filter li a.all');var $filterType=$('.quicksand-filter li.active a').attr('href').replace('#','');$('.quicksand-filter li a').on('click',function(){onClickQuicksand(this,$defaultFilter,$filterType,$gallery,$data);});$('.nav-select').on('change',function(){onClickQuicksand(this,$defaultFilter,$filterType,$gallery,$data);});$(window).resize(function(){$gallery.css({'width':'','height':''});});}
function onClickQuicksand(obj,$defaultFilter,$filterType,$gallery,$data){if($(obj).hasClass('nav-select')){$('.drop-list li').removeClass('item-selected');var $filterType=$('.nav-select').val().replace('#','');}else{$('.quicksand-filter li').removeClass('active');var $filterType=$(obj).attr('href').replace('#','');$(obj).parent().addClass('active');}
if($filterType=='all'){var $filteredData=$data.find('li');}
else{var $filteredData=$data.find('li[data-type~='+$filterType+']');}
$gallery.quicksand($filteredData,{duration:600,useScaling:true,easing:'easeInOutQuad',},function(){initLayout();initTouchNav();initLightbox();$(window).resize();});}
function initNewsLetter(){$(".subscribe-block form").submit(function(event){event.preventDefault();var form=$(this);var postData=form.serialize();var success=form.find('label');var status=form.find('.status');$.ajax({type:"POST",url:"scripts/subscription.php",data:postData,success:function(data){if(data=="success"){form.find('.box').hide();success.html("<span>Thanks for your interest!</span> We will let you know.").slideDown();}else if(data=="subscribed")
status.html("This email is already subscribed.").slideDown();else if(data=="invalid")
status.html("This email is invalid.").slideDown();else
status.html("Oups, something went wrong!").slideDown();},error:function(){status.html("Oups, something went wrong!").slideDown();}});});}
function initContactForm(){$("#contact").submit(function(event){event.preventDefault();var form=$(this);var postData=form.serialize();var status=form.parent().find(".error");var success=form.parent().find(".success");form.find('[name=email]').removeClass('error');$.ajax({type:"POST",url:"scripts/writeus.php",data:postData,success:function(data){if(data=="success"){status.html("").hide();form.hide();success.fadeIn();}else if(data=="invalid"){form.find('[name=email]').addClass('error');status.html("This email is invalid.").slideDown();}else{status.html("Oups, something went wrong!").slideDown();}},error:function(){status.html("Oups, something went wrong!").slideDown();}});});};(function($){$.fn.slideAccordion=function(opt){var options=$.extend({addClassBeforeAnimation:false,activeClass:'active',opener:'.opener',slider:'.slide',animSpeed:300,collapsible:true,event:'click'},opt);return this.each(function(){var accordion=$(this);var items=accordion.find(':has('+options.slider+')');items.each(function(){var item=$(this);var opener=item.find(options.opener);var slider=item.find(options.slider);opener.bind(options.event,function(e){if(!slider.is(':animated')){if(item.hasClass(options.activeClass)){if(options.collapsible){slider.slideUp(options.animSpeed,function(){hideSlide(slider);item.removeClass(options.activeClass);});}}else{var levelItems=item.siblings('.'+options.activeClass);var sliderElements=levelItems.find(options.slider);item.addClass(options.activeClass);showSlide(slider).hide().slideDown(options.animSpeed);sliderElements.slideUp(options.animSpeed,function(){levelItems.removeClass(options.activeClass);hideSlide(sliderElements);});}}
e.preventDefault();});if(item.hasClass(options.activeClass))showSlide(slider);else hideSlide(slider);});});};var showSlide=function(slide){return slide.css({position:'',top:'',left:'',width:''});};var hideSlide=function(slide){return slide.show().css({position:'absolute',top:-9999,left:-9999,width:slide.width()});};}(jQuery));;(function($){function ContentPopup(opt){this.options=$.extend({holder:null,popup:'.popup',btnOpen:'.open',btnClose:'.close',openClass:'popup-active',clickEvent:'click',mode:'click',hideOnClickLink:true,hideOnClickOutside:true,delay:50},opt);if(this.options.holder){this.holder=$(this.options.holder);this.init();}}
ContentPopup.prototype={init:function(){this.findElements();this.attachEvents();},findElements:function(){this.popup=this.holder.find(this.options.popup);this.btnOpen=this.holder.find(this.options.btnOpen);this.btnClose=this.holder.find(this.options.btnClose);},attachEvents:function(){var self=this;this.clickMode=isTouchDevice||(self.options.mode===self.options.clickEvent);if(this.clickMode){this.btnOpen.bind(self.options.clickEvent,function(e){if(self.holder.hasClass(self.options.openClass)){if(self.options.hideOnClickLink){self.hidePopup();}}else{self.showPopup();}
e.preventDefault();});this.outsideClickHandler=this.bind(this.outsideClickHandler,this);}else{var timer,delayedFunc=function(func){clearTimeout(timer);timer=setTimeout(function(){func.call(self);},self.options.delay);};this.btnOpen.bind('mouseover',function(){delayedFunc(self.showPopup);}).bind('mouseout',function(){delayedFunc(self.hidePopup);});this.popup.bind('mouseover',function(){delayedFunc(self.showPopup);}).bind('mouseout',function(){delayedFunc(self.hidePopup);});}
this.btnClose.bind(self.options.clickEvent,function(e){self.hidePopup();e.preventDefault();});},outsideClickHandler:function(e){var currentNode=(e.changedTouches?e.changedTouches[0]:e).target;if(!$(currentNode).parents().filter(this.holder).length){this.hidePopup();}},showPopup:function(){this.holder.addClass(this.options.openClass);this.popup.css({display:'block'});if(this.clickMode&&this.options.hideOnClickOutside&&!this.outsideHandlerActive){this.outsideHandlerActive=true;$(document).bind('click touchstart',this.outsideClickHandler);}},hidePopup:function(){this.holder.removeClass(this.options.openClass);this.popup.css({display:'none'});if(this.clickMode&&this.options.hideOnClickOutside&&this.outsideHandlerActive){this.outsideHandlerActive=false;$(document).unbind('click touchstart',this.outsideClickHandler);}},bind:function(f,scope,forceArgs){return function(){return f.apply(scope,forceArgs?[forceArgs]:arguments);};}};var isTouchDevice=/MSIE 10.*Touch/.test(navigator.userAgent)||('ontouchstart'in window)||window.DocumentTouch&&document instanceof DocumentTouch;$.fn.contentPopup=function(opt){return this.each(function(){new ContentPopup($.extend(opt,{holder:this}));});};}(jQuery));;(function($){$.fn.sameHeight=function(opt){var options=$.extend({skipClass:'same-height-ignore',leftEdgeClass:'same-height-left',rightEdgeClass:'same-height-right',elements:'>*',flexible:false,multiLine:false,useMinHeight:false,biggestHeight:false},opt);return this.each(function(){var holder=$(this),postResizeTimer,ignoreResize;var elements=holder.find(options.elements).not('.'+options.skipClass);if(!elements.length)return;function doResize(){elements.css(options.useMinHeight&&supportMinHeight?'minHeight':'height','');if(options.multiLine){resizeElementsByRows(elements,options);}else{resizeElements(elements,holder,options);}}
doResize();var delayedResizeHandler=function(){if(!ignoreResize){ignoreResize=true;doResize();clearTimeout(postResizeTimer);postResizeTimer=setTimeout(function(){doResize();setTimeout(function(){ignoreResize=false;},10);},100);}};if(options.flexible){$(window).bind('resize orientationchange fontresize',delayedResizeHandler);}
$(window).bind('load',delayedResizeHandler);});};var supportMinHeight=typeof document.documentElement.style.maxHeight!=='undefined';function resizeElementsByRows(boxes,options){var currentRow=$(),maxHeight,maxCalcHeight=0,firstOffset=boxes.eq(0).offset().top;boxes.each(function(ind){var curItem=$(this);if(curItem.offset().top===firstOffset){currentRow=currentRow.add(this);}else{maxHeight=getMaxHeight(currentRow);maxCalcHeight=Math.max(maxCalcHeight,resizeElements(currentRow,maxHeight,options));currentRow=curItem;firstOffset=curItem.offset().top;}});if(currentRow.length){maxHeight=getMaxHeight(currentRow);maxCalcHeight=Math.max(maxCalcHeight,resizeElements(currentRow,maxHeight,options));}
if(options.biggestHeight){boxes.css(options.useMinHeight&&supportMinHeight?'minHeight':'height',maxCalcHeight);}}
function getMaxHeight(boxes){var maxHeight=0;boxes.each(function(){maxHeight=Math.max(maxHeight,$(this).outerHeight());});return maxHeight;}
function resizeElements(boxes,parent,options){var calcHeight;var parentHeight=typeof parent==='number'?parent:parent.height();boxes.removeClass(options.leftEdgeClass).removeClass(options.rightEdgeClass).each(function(i){var element=$(this);var depthDiffHeight=0;if(typeof parent!=='number'){element.parents().each(function(){var tmpParent=$(this);if(this===parent[0]){return false;}else{depthDiffHeight+=tmpParent.outerHeight()-tmpParent.height();}});}
calcHeight=parentHeight-depthDiffHeight-(element.outerHeight()-element.height());if(calcHeight>0){element.css(options.useMinHeight&&supportMinHeight?'minHeight':'height',calcHeight);}});boxes.filter(':first').addClass(options.leftEdgeClass);boxes.filter(':last').addClass(options.rightEdgeClass);return calcHeight;}}(jQuery));;(function($){function NavigationSelect(options){this.options=$.extend({list:null,levelIndentHTML:' &bull; ',defaultOptionAttr:'title',defaultOptionText:'...',selectClass:'nav-select',activeClass:'nav-active',defaultOptionClass:'opt-default',hasDropClass:'opt-sublevel',levelPrefixClass:'opt-level-',useDefaultOption:true},options);if(this.options.list){this.createSelect();this.attachEvents();}}
NavigationSelect.prototype={createSelect:function(){var self=this;this.startIndex=0;this.navigation=$(this.options.list);this.select=$('<select>').addClass(this.options.selectClass);this.createDefaultOption();this.createList(this.navigation,0);this.select.insertBefore(this.navigation);},createDefaultOption:function(){if(this.options.useDefaultOption){var attrText=this.navigation.attr(this.options.defaultOptionAttr);var defaultOption=$('<option>').addClass(this.options.defaultOptionClass).text(attrText||this.options.defaultOptionText);this.navigation.removeAttr(this.options.defaultOptionAttr);this.select.append(defaultOption);this.startIndex=1;}},createList:function(list,level){var self=this;list.children().each(function(index,item){var listItem=$(this),listLink=listItem.find('a').eq(0),listDrop=listItem.find('ul').eq(0),hasDrop=listDrop.length>0;if(listLink.length){self.select.append(self.createOption(listLink,hasDrop,level,listLink.hasClass(self.options.activeClass)));}
if(hasDrop){self.createList(listDrop,level+1);}});},createOption:function(link,hasDrop,level,selected){var optionHTML=this.getLevelIndent(level)+link.html();return $('<option>').html(optionHTML).addClass(this.options.levelPrefixClass+(level+1)).toggleClass(this.options.hasDropClass,hasDrop).val(link.attr('href')).attr('selected',selected?'selected':false);},getLevelIndent:function(level){return(new Array(level+1)).join(this.options.levelIndentHTML);},attachEvents:function(){var self=this;this.select.change(function(){if(this.selectedIndex>=self.startIndex){location.href=this.value;}});}};$.fn.navigationSelect=function(opt){return this.each(function(){new NavigationSelect($.extend({list:this},opt));});};}(jQuery));jQuery.onFontResize=(function($){$(function(){var randomID='font-resize-frame-'+Math.floor(Math.random()*1000);var resizeFrame=$('<iframe>').attr('id',randomID).addClass('font-resize-helper');resizeFrame.css({width:'100em',height:'10px',position:'absolute',borderWidth:0,top:'-9999px',left:'-9999px'}).appendTo('body');if(window.attachEvent&&!window.addEventListener){resizeFrame.bind('resize',function(){$.onFontResize.trigger(resizeFrame[0].offsetWidth/100);});}
else{var doc=resizeFrame[0].contentWindow.document;doc.open();doc.write('<scri'+'pt>window.onload = function(){var em = parent.jQuery("#'+randomID+'")[0];window.onresize = function(){if(parent.jQuery.onFontResize){parent.jQuery.onFontResize.trigger(em.offsetWidth / 100);}}};</scri'+'pt>');doc.close();}
jQuery.onFontResize.initialSize=resizeFrame[0].offsetWidth/100;});return{trigger:function(em){$(window).trigger("fontresize",[em]);}};}(jQuery));jcf={modules:{},plugins:{},baseOptions:{unselectableClass:'jcf-unselectable',labelActiveClass:'jcf-label-active',labelDisabledClass:'jcf-label-disabled',classPrefix:'jcf-class-',hiddenClass:'jcf-hidden',focusClass:'jcf-focus',wrapperTag:'div'},customForms:{setOptions:function(obj){for(var p in obj){if(obj.hasOwnProperty(p)&&typeof obj[p]==='object'){jcf.lib.extend(jcf.modules[p].prototype.defaultOptions,obj[p]);}}},replaceAll:function(){for(var k in jcf.modules){var els=jcf.lib.queryBySelector(jcf.modules[k].prototype.selector);for(var i=0;i<els.length;i++){if(els[i].jcf){els[i].jcf.refreshState();}else{if(!jcf.lib.hasClass(els[i],'default')&&jcf.modules[k].prototype.checkElement(els[i])){new jcf.modules[k]({replaces:els[i]});}}}}},refreshAll:function(){for(var k in jcf.modules){var els=jcf.lib.queryBySelector(jcf.modules[k].prototype.selector);for(var i=0;i<els.length;i++){if(els[i].jcf){els[i].jcf.refreshState();}}}},refreshElement:function(obj){if(obj&&obj.jcf){obj.jcf.refreshState();}},destroyAll:function(){for(var k in jcf.modules){var els=jcf.lib.queryBySelector(jcf.modules[k].prototype.selector);for(var i=0;i<els.length;i++){if(els[i].jcf){els[i].jcf.destroy();}}}}},isTouchDevice:('ontouchstart'in window)||window.DocumentTouch&&document instanceof DocumentTouch,isWinPhoneDevice:navigator.msPointerEnabled&&/MSIE 10.*Touch/.test(navigator.userAgent),setBaseModule:function(obj){jcf.customControl=function(opt){this.options=jcf.lib.extend({},jcf.baseOptions,this.defaultOptions,opt);this.init();};for(var p in obj){jcf.customControl.prototype[p]=obj[p];}},addModule:function(obj){if(obj.name){jcf.modules[obj.name]=function(){jcf.modules[obj.name].superclass.constructor.apply(this,arguments);};jcf.lib.inherit(jcf.modules[obj.name],jcf.customControl);for(var p in obj){jcf.modules[obj.name].prototype[p]=obj[p];}
jcf.modules[obj.name].prototype.onCreateModule();for(var mod in jcf.modules){if(jcf.modules[mod]!=jcf.modules[obj.name]){jcf.modules[mod].prototype.onModuleAdded(jcf.modules[obj.name]);}}}},addPlugin:function(obj){if(obj&&obj.name){jcf.plugins[obj.name]=function(){this.init.apply(this,arguments);};for(var p in obj){jcf.plugins[obj.name].prototype[p]=obj[p];}}},init:function(){if(navigator.msPointerEnabled){this.eventPress='MSPointerDown';this.eventMove='MSPointerMove';this.eventRelease='MSPointerUp';}else{this.eventPress=this.isTouchDevice?'touchstart':'mousedown';this.eventMove=this.isTouchDevice?'touchmove':'mousemove';this.eventRelease=this.isTouchDevice?'touchend':'mouseup';}
setTimeout(function(){jcf.lib.domReady(function(){jcf.initStyles();});},1);return this;},initStyles:function(){var head=document.getElementsByTagName('head')[0],style=document.createElement('style'),rules=document.createTextNode('.'+jcf.baseOptions.unselectableClass+'{'+
'-moz-user-select:none;'+
'-webkit-tap-highlight-color:rgba(255,255,255,0);'+
'-webkit-user-select:none;'+
'user-select:none;'+
'}');style.type='text/css';if(style.styleSheet){style.styleSheet.cssText=rules.nodeValue;}else{style.appendChild(rules);}
head.appendChild(style);}}.init();jcf.setBaseModule({init:function(){if(this.options.replaces){this.realElement=this.options.replaces;this.realElement.jcf=this;this.replaceObject();}},defaultOptions:{},checkElement:function(el){return true;},replaceObject:function(){this.createWrapper();this.attachEvents();this.fixStyles();this.setupWrapper();},createWrapper:function(){this.fakeElement=jcf.lib.createElement(this.options.wrapperTag);this.labelFor=jcf.lib.getLabelFor(this.realElement);jcf.lib.disableTextSelection(this.fakeElement);jcf.lib.addClass(this.fakeElement,jcf.lib.getAllClasses(this.realElement.className,this.options.classPrefix));jcf.lib.addClass(this.realElement,jcf.baseOptions.hiddenClass);},attachEvents:function(){jcf.lib.event.add(this.realElement,'focus',this.onFocusHandler,this);jcf.lib.event.add(this.realElement,'blur',this.onBlurHandler,this);jcf.lib.event.add(this.fakeElement,'click',this.onFakeClick,this);jcf.lib.event.add(this.fakeElement,jcf.eventPress,this.onFakePressed,this);jcf.lib.event.add(this.fakeElement,jcf.eventRelease,this.onFakeReleased,this);if(this.labelFor){this.labelFor.jcf=this;jcf.lib.event.add(this.labelFor,'click',this.onFakeClick,this);jcf.lib.event.add(this.labelFor,jcf.eventPress,this.onFakePressed,this);jcf.lib.event.add(this.labelFor,jcf.eventRelease,this.onFakeReleased,this);}},fixStyles:function(){if(jcf.isTouchDevice){var tapStyle='rgba(255,255,255,0)';this.realElement.style.webkitTapHighlightColor=tapStyle;this.fakeElement.style.webkitTapHighlightColor=tapStyle;if(this.labelFor){this.labelFor.style.webkitTapHighlightColor=tapStyle;}}},setupWrapper:function(){},refreshState:function(){},destroy:function(){if(this.fakeElement&&this.fakeElement.parentNode){this.fakeElement.parentNode.removeChild(this.fakeElement);}
jcf.lib.removeClass(this.realElement,jcf.baseOptions.hiddenClass);this.realElement.jcf=null;},onFocus:function(){jcf.lib.addClass(this.fakeElement,this.options.focusClass);},onBlur:function(cb){jcf.lib.removeClass(this.fakeElement,this.options.focusClass);},onFocusHandler:function(){if(this.focused)return;this.focused=true;if(jcf.isTouchDevice){if(jcf.focusedInstance&&jcf.focusedInstance.realElement!=this.realElement){jcf.focusedInstance.onBlur();jcf.focusedInstance.realElement.blur();}
jcf.focusedInstance=this;}
this.onFocus.apply(this,arguments);},onBlurHandler:function(){if(!this.pressedFlag){this.focused=false;this.onBlur.apply(this,arguments);}},onFakeClick:function(){if(jcf.isTouchDevice){this.onFocus();}else if(!this.realElement.disabled){this.realElement.focus();}},onFakePressed:function(e){this.pressedFlag=true;},onFakeReleased:function(){this.pressedFlag=false;},onCreateModule:function(){},onModuleAdded:function(module){},onControlReady:function(){}});jcf.lib={bind:function(func,scope){return function(){return func.apply(scope,arguments);}},browser:(function(){var ua=navigator.userAgent.toLowerCase(),res={},match=/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(ua)||[];res[match[1]]=true;res.version=match[2]||"0";res.safariMac=ua.indexOf('mac')!=-1&&ua.indexOf('safari')!=-1;return res;})(),getOffset:function(obj){if(obj.getBoundingClientRect&&!navigator.msPointerEnabled){var scrollLeft=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft;var scrollTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;var clientLeft=document.documentElement.clientLeft||document.body.clientLeft||0;var clientTop=document.documentElement.clientTop||document.body.clientTop||0;return{top:Math.round(obj.getBoundingClientRect().top+scrollTop-clientTop),left:Math.round(obj.getBoundingClientRect().left+scrollLeft-clientLeft)}}else{var posLeft=0,posTop=0;while(obj.offsetParent){posLeft+=obj.offsetLeft;posTop+=obj.offsetTop;obj=obj.offsetParent;}
return{top:posTop,left:posLeft};}},getScrollTop:function(){return window.pageYOffset||document.documentElement.scrollTop;},getScrollLeft:function(){return window.pageXOffset||document.documentElement.scrollLeft;},getWindowWidth:function(){return document.compatMode=='CSS1Compat'?document.documentElement.clientWidth:document.body.clientWidth;},getWindowHeight:function(){return document.compatMode=='CSS1Compat'?document.documentElement.clientHeight:document.body.clientHeight;},getStyle:function(el,prop){if(document.defaultView&&document.defaultView.getComputedStyle){return document.defaultView.getComputedStyle(el,null)[prop];}else if(el.currentStyle){return el.currentStyle[prop];}else{return el.style[prop];}},getParent:function(obj,selector){while(obj.parentNode&&obj.parentNode!=document.body){if(obj.parentNode.tagName.toLowerCase()==selector.toLowerCase()){return obj.parentNode;}
obj=obj.parentNode;}
return false;},isParent:function(child,parent){while(child.parentNode){if(child.parentNode===parent){return true;}
child=child.parentNode;}
return false;},getLabelFor:function(object){var parentLabel=jcf.lib.getParent(object,'label');if(parentLabel){return parentLabel;}else if(object.id){return jcf.lib.queryBySelector('label[for="'+object.id+'"]')[0];}},disableTextSelection:function(el){if(typeof el.onselectstart!=='undefined'){el.onselectstart=function(){return false};}else if(window.opera){el.setAttribute('unselectable','on');}else{jcf.lib.addClass(el,jcf.baseOptions.unselectableClass);}},enableTextSelection:function(el){if(typeof el.onselectstart!=='undefined'){el.onselectstart=null;}else if(window.opera){el.removeAttribute('unselectable');}else{jcf.lib.removeClass(el,jcf.baseOptions.unselectableClass);}},queryBySelector:function(selector,scope){return this.getElementsBySelector(selector,scope);},prevSibling:function(node){while(node=node.previousSibling)if(node.nodeType==1)break;return node;},nextSibling:function(node){while(node=node.nextSibling)if(node.nodeType==1)break;return node;},fireEvent:function(element,event){if(element.dispatchEvent){var evt=document.createEvent('HTMLEvents');evt.initEvent(event,true,true);return!element.dispatchEvent(evt);}else if(document.createEventObject){var evt=document.createEventObject();return element.fireEvent('on'+event,evt);}},isParent:function(p,c){while(c.parentNode){if(p==c){return true;}
c=c.parentNode;}
return false;},inherit:function(Child,Parent){var F=function(){}
F.prototype=Parent.prototype
Child.prototype=new F()
Child.prototype.constructor=Child
Child.superclass=Parent.prototype},extend:function(obj){for(var i=1;i<arguments.length;i++){for(var p in arguments[i]){if(arguments[i].hasOwnProperty(p)){obj[p]=arguments[i][p];}}}
return obj;},hasClass:function(obj,cname){return(obj.className?obj.className.match(new RegExp('(\\s|^)'+cname+'(\\s|$)')):false);},addClass:function(obj,cname){if(!this.hasClass(obj,cname))obj.className+=(!obj.className.length||obj.className.charAt(obj.className.length-1)===' '?'':' ')+cname;},removeClass:function(obj,cname){if(this.hasClass(obj,cname))obj.className=obj.className.replace(new RegExp('(\\s|^)'+cname+'(\\s|$)'),' ').replace(/\s+$/,'');},toggleClass:function(obj,cname,condition){if(condition)this.addClass(obj,cname);else this.removeClass(obj,cname);},createElement:function(tagName,options){var el=document.createElement(tagName);for(var p in options){if(options.hasOwnProperty(p)){switch(p){case 'class':el.className=options[p];break;case 'html':el.innerHTML=options[p];break;case 'style':this.setStyles(el,options[p]);break;default:el.setAttribute(p,options[p]);}}}
return el;},setStyles:function(el,styles){for(var p in styles){if(styles.hasOwnProperty(p)){switch(p){case 'float':el.style.cssFloat=styles[p];break;case 'opacity':el.style.filter='progid:DXImageTransform.Microsoft.Alpha(opacity='+styles[p]*100+')';el.style.opacity=styles[p];break;default:el.style[p]=(typeof styles[p]==='undefined'?0:styles[p])+(typeof styles[p]==='number'?'px':'');}}}
return el;},getInnerWidth:function(el){return el.offsetWidth-(parseInt(this.getStyle(el,'paddingLeft'))||0)-(parseInt(this.getStyle(el,'paddingRight'))||0);},getInnerHeight:function(el){return el.offsetHeight-(parseInt(this.getStyle(el,'paddingTop'))||0)-(parseInt(this.getStyle(el,'paddingBottom'))||0);},getAllClasses:function(cname,prefix,skip){if(!skip)skip='';if(!prefix)prefix='';return cname?cname.replace(new RegExp('(\\s|^)'+skip+'(\\s|$)'),' ').replace(/[\s]*([\S]+)+[\s]*/gi,prefix+"$1 "):'';},getElementsBySelector:function(selector,scope){if(typeof document.querySelectorAll==='function'){return(scope||document).querySelectorAll(selector);}
var selectors=selector.split(',');var resultList=[];for(var s=0;s<selectors.length;s++){var currentContext=[scope||document];var tokens=selectors[s].replace(/^\s+/,'').replace(/\s+$/,'').split(' ');for(var i=0;i<tokens.length;i++){token=tokens[i].replace(/^\s+/,'').replace(/\s+$/,'');if(token.indexOf('#')>-1){var bits=token.split('#'),tagName=bits[0],id=bits[1];var element=document.getElementById(id);if(tagName&&element.nodeName.toLowerCase()!=tagName){return[];}
currentContext=[element];continue;}
if(token.indexOf('.')>-1){var bits=token.split('.'),tagName=bits[0]||'*',className=bits[1],found=[],foundCount=0;for(var h=0;h<currentContext.length;h++){var elements;if(tagName=='*'){elements=currentContext[h].getElementsByTagName('*');}else{elements=currentContext[h].getElementsByTagName(tagName);}
for(var j=0;j<elements.length;j++){found[foundCount++]=elements[j];}}
currentContext=[];var currentContextIndex=0;for(var k=0;k<found.length;k++){if(found[k].className&&found[k].className.match(new RegExp('(\\s|^)'+className+'(\\s|$)'))){currentContext[currentContextIndex++]=found[k];}}
continue;}
if(token.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){var tagName=RegExp.$1||'*',attrName=RegExp.$2,attrOperator=RegExp.$3,attrValue=RegExp.$4;if(attrName.toLowerCase()=='for'&&this.browser.msie&&this.browser.version<8){attrName='htmlFor';}
var found=[],foundCount=0;for(var h=0;h<currentContext.length;h++){var elements;if(tagName=='*'){elements=currentContext[h].getElementsByTagName('*');}else{elements=currentContext[h].getElementsByTagName(tagName);}
for(var j=0;elements[j];j++){found[foundCount++]=elements[j];}}
currentContext=[];var currentContextIndex=0,checkFunction;switch(attrOperator){case '=':checkFunction=function(e){return(e.getAttribute(attrName)==attrValue)};break;case '~':checkFunction=function(e){return(e.getAttribute(attrName).match(new RegExp('(\\s|^)'+attrValue+'(\\s|$)')))};break;case '|':checkFunction=function(e){return(e.getAttribute(attrName).match(new RegExp('^'+attrValue+'-?')))};break;case '^':checkFunction=function(e){return(e.getAttribute(attrName).indexOf(attrValue)==0)};break;case '$':checkFunction=function(e){return(e.getAttribute(attrName).lastIndexOf(attrValue)==e.getAttribute(attrName).length-attrValue.length)};break;case '*':checkFunction=function(e){return(e.getAttribute(attrName).indexOf(attrValue)>-1)};break;default:checkFunction=function(e){return e.getAttribute(attrName)};}
currentContext=[];var currentContextIndex=0;for(var k=0;k<found.length;k++){if(checkFunction(found[k])){currentContext[currentContextIndex++]=found[k];}}
continue;}
tagName=token;var found=[],foundCount=0;for(var h=0;h<currentContext.length;h++){var elements=currentContext[h].getElementsByTagName(tagName);for(var j=0;j<elements.length;j++){found[foundCount++]=elements[j];}}
currentContext=found;}
resultList=[].concat(resultList,currentContext);}
return resultList;},scrollSize:(function(){var content,hold,sizeBefore,sizeAfter;function buildSizer(){if(hold)removeSizer();content=document.createElement('div');hold=document.createElement('div');hold.style.cssText='position:absolute;overflow:hidden;width:100px;height:100px';hold.appendChild(content);document.body.appendChild(hold);}
function removeSizer(){document.body.removeChild(hold);hold=null;}
function calcSize(vertical){buildSizer();content.style.cssText='height:'+(vertical?'100%':'200px');sizeBefore=(vertical?content.offsetHeight:content.offsetWidth);hold.style.overflow='scroll';content.innerHTML=1;sizeAfter=(vertical?content.offsetHeight:content.offsetWidth);if(vertical&&hold.clientHeight)sizeAfter=hold.clientHeight;removeSizer();return sizeBefore-sizeAfter;}
return{getWidth:function(){return calcSize(false);},getHeight:function(){return calcSize(true)}}}()),domReady:function(handler){var called=false
function ready(){if(called)return;called=true;handler();}
if(document.addEventListener){document.addEventListener("DOMContentLoaded",ready,false);}else if(document.attachEvent){if(document.documentElement.doScroll&&window==window.top){function tryScroll(){if(called)return
if(!document.body)return
try{document.documentElement.doScroll("left")
ready()}catch(e){setTimeout(tryScroll,0)}}
tryScroll()}
document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){ready()}})}
if(window.addEventListener)window.addEventListener('load',ready,false)
else if(window.attachEvent)window.attachEvent('onload',ready)},event:(function(){var guid=0;function fixEvent(e){e=e||window.event;if(e.isFixed){return e;}
e.isFixed=true;e.preventDefault=e.preventDefault||function(){this.returnValue=false}
e.stopPropagation=e.stopPropagaton||function(){this.cancelBubble=true}
if(!e.target){e.target=e.srcElement}
if(!e.relatedTarget&&e.fromElement){e.relatedTarget=e.fromElement==e.target?e.toElement:e.fromElement;}
if(e.pageX==null&&e.clientX!=null){var html=document.documentElement,body=document.body;e.pageX=e.clientX+(html&&html.scrollLeft||body&&body.scrollLeft||0)-(html.clientLeft||0);e.pageY=e.clientY+(html&&html.scrollTop||body&&body.scrollTop||0)-(html.clientTop||0);}
if(!e.which&&e.button){e.which=e.button&1?1:(e.button&2?3:(e.button&4?2:0));}
if(e.type==="DOMMouseScroll"||e.type==='mousewheel'){e.mWheelDelta=0;if(e.wheelDelta){e.mWheelDelta=e.wheelDelta/120;}else if(e.detail){e.mWheelDelta=-e.detail/3;}}
return e;}
function commonHandle(event,customScope){event=fixEvent(event);var handlers=this.events[event.type];for(var g in handlers){var handler=handlers[g];var ret=handler.call(customScope||this,event);if(ret===false){event.preventDefault()
event.stopPropagation()}}}
var publicAPI={add:function(elem,type,handler,forcedScope){if(elem.setInterval&&(elem!=window&&!elem.frameElement)){elem=window;}
if(!handler.guid){handler.guid=++guid;}
if(!elem.events){elem.events={};elem.handle=function(event){return commonHandle.call(elem,event);}}
if(!elem.events[type]){elem.events[type]={};if(elem.addEventListener)elem.addEventListener(type,elem.handle,false);else if(elem.attachEvent)elem.attachEvent("on"+type,elem.handle);if(type==='mousewheel'){publicAPI.add(elem,'DOMMouseScroll',handler,forcedScope);}}
var fakeHandler=jcf.lib.bind(handler,forcedScope);fakeHandler.guid=handler.guid;elem.events[type][handler.guid]=forcedScope?fakeHandler:handler;},remove:function(elem,type,handler){var handlers=elem.events&&elem.events[type];if(!handlers)return;delete handlers[handler.guid];for(var any in handlers)return;if(elem.removeEventListener)elem.removeEventListener(type,elem.handle,false);else if(elem.detachEvent)elem.detachEvent("on"+type,elem.handle);delete elem.events[type];for(var any in elem.events)return;try{delete elem.handle;delete elem.events;}catch(e){if(elem.removeAttribute){elem.removeAttribute("handle");elem.removeAttribute("events");}}
if(type==='mousewheel'){publicAPI.remove(elem,'DOMMouseScroll',handler);}}}
return publicAPI;}())}
jcf.addModule({name:'select',selector:'select',defaultOptions:{useNativeDropOnMobileDevices:true,hideDropOnScroll:true,showNativeDrop:false,handleDropPosition:true,selectDropPosition:'bottom',wrapperClass:'select-area',focusClass:'select-focus',dropActiveClass:'select-active',selectedClass:'item-selected',currentSelectedClass:'current-selected',disabledClass:'select-disabled',valueSelector:'span.center',optGroupClass:'optgroup',openerSelector:'a.select-opener',selectStructure:'<span class="left"></span><span class="center"></span><a class="select-opener"></a>',wrapperTag:'span',classPrefix:'select-',dropMaxHeight:200,dropFlippedClass:'select-options-flipped',dropHiddenClass:'options-hidden',dropScrollableClass:'options-overflow',dropClass:'select-options',dropClassPrefix:'drop-',dropStructure:'<div class="drop-holder"><div class="drop-list"></div></div>',dropSelector:'div.drop-list'},checkElement:function(el){return(!el.size&&!el.multiple);},setupWrapper:function(){jcf.lib.addClass(this.fakeElement,this.options.wrapperClass);this.realElement.parentNode.insertBefore(this.fakeElement,this.realElement);this.fakeElement.innerHTML=this.options.selectStructure;this.fakeElement.style.width=(this.realElement.offsetWidth>0?this.realElement.offsetWidth+'px':'auto');if(jcf.baseOptions.useNativeDropOnMobileDevices&&(jcf.isTouchDevice||jcf.isWinPhoneDevice)){this.options.showNativeDrop=true;}
if(this.options.showNativeDrop){this.fakeElement.appendChild(this.realElement);jcf.lib.removeClass(this.realElement,this.options.hiddenClass);jcf.lib.setStyles(this.realElement,{top:0,left:0,margin:0,padding:0,opacity:0,border:'none',position:'absolute',width:jcf.lib.getInnerWidth(this.fakeElement)-1,height:jcf.lib.getInnerHeight(this.fakeElement)-1});jcf.lib.event.add(this.realElement,'touchstart',function(){this.realElement.title='';},this)}
this.opener=jcf.lib.queryBySelector(this.options.openerSelector,this.fakeElement)[0];this.valueText=jcf.lib.queryBySelector(this.options.valueSelector,this.fakeElement)[0];jcf.lib.disableTextSelection(this.valueText);this.opener.jcf=this;if(!this.options.showNativeDrop){this.createDropdown();this.refreshState();this.onControlReady(this);this.hideDropdown(true);}else{this.refreshState();}
this.addEvents();},addEvents:function(){if(this.options.showNativeDrop){jcf.lib.event.add(this.realElement,'click',this.onChange,this);}else{jcf.lib.event.add(this.fakeElement,'click',this.toggleDropdown,this);}
jcf.lib.event.add(this.realElement,'change',this.onChange,this);},onFakeClick:function(){},onFocus:function(){jcf.modules[this.name].superclass.onFocus.apply(this,arguments);if(!this.options.showNativeDrop){if(jcf.lib.browser.safariMac){this.realElement.setAttribute('size','2');}
jcf.lib.event.add(this.realElement,'keydown',this.onKeyDown,this);if(jcf.activeControl&&jcf.activeControl!=this){jcf.activeControl.hideDropdown();jcf.activeControl=this;}}},onBlur:function(){if(!this.options.showNativeDrop){if(jcf.lib.browser.safariMac){this.realElement.removeAttribute('size');}
if(!this.isActiveDrop()||!this.isOverDrop()){jcf.modules[this.name].superclass.onBlur.apply(this);if(jcf.activeControl===this)jcf.activeControl=null;if(!jcf.isTouchDevice){this.hideDropdown();}}
jcf.lib.event.remove(this.realElement,'keydown',this.onKeyDown);}else{jcf.modules[this.name].superclass.onBlur.apply(this);}},onChange:function(){this.refreshState();},onKeyDown:function(e){this.dropOpened=true;jcf.tmpFlag=true;setTimeout(function(){jcf.tmpFlag=false},100);var context=this;context.keyboardFix=true;setTimeout(function(){context.refreshState();},10);if(e.keyCode==13){context.toggleDropdown.apply(context);return false;}},onResizeWindow:function(e){if(this.isActiveDrop()){this.hideDropdown();}},onScrollWindow:function(e){if(this.options.hideDropOnScroll){this.hideDropdown();}else if(this.isActiveDrop()){this.positionDropdown();}},onOptionClick:function(e){var opener=e.target&&e.target.tagName&&e.target.tagName.toLowerCase()=='li'?e.target:jcf.lib.getParent(e.target,'li');if(opener){this.dropOpened=true;this.realElement.selectedIndex=parseInt(opener.getAttribute('rel'));if(jcf.isTouchDevice){this.onFocus();}else{this.realElement.focus();}
this.refreshState();this.hideDropdown();jcf.lib.fireEvent(this.realElement,'change');$(e.target).attr('href',$(this.realElement).val());}
return false;},onClickOutside:function(e){if(jcf.tmpFlag){jcf.tmpFlag=false;return;}
if(!jcf.lib.isParent(this.fakeElement,e.target)&&!jcf.lib.isParent(this.selectDrop,e.target)){this.hideDropdown();}},onDropHover:function(e){if(!this.keyboardFix){this.hoverFlag=true;var opener=e.target&&e.target.tagName&&e.target.tagName.toLowerCase()=='li'?e.target:jcf.lib.getParent(e.target,'li');if(opener){this.realElement.selectedIndex=parseInt(opener.getAttribute('rel'));this.refreshSelectedClass(parseInt(opener.getAttribute('rel')));}}else{this.keyboardFix=false;}},onDropLeave:function(){this.hoverFlag=false;},isActiveDrop:function(){return!jcf.lib.hasClass(this.selectDrop,this.options.dropHiddenClass);},isOverDrop:function(){return this.hoverFlag;},createDropdown:function(){if(this.selectDrop){this.selectDrop.parentNode.removeChild(this.selectDrop);}
this.selectDrop=document.createElement('div');this.selectDrop.className=this.options.dropClass;this.selectDrop.innerHTML=this.options.dropStructure;jcf.lib.setStyles(this.selectDrop,{position:'absolute'});this.selectList=jcf.lib.queryBySelector(this.options.dropSelector,this.selectDrop)[0];jcf.lib.addClass(this.selectDrop,this.options.dropHiddenClass);document.body.appendChild(this.selectDrop);this.selectDrop.jcf=this;jcf.lib.event.add(this.selectDrop,'click',this.onOptionClick,this);jcf.lib.event.add(this.selectDrop,'mouseover',this.onDropHover,this);jcf.lib.event.add(this.selectDrop,'mouseout',this.onDropLeave,this);this.buildDropdown();},buildDropdown:function(){this.buildDropdownOptions();this.positionDropdown();this.buildDropdownScroll();},buildDropdownOptions:function(){this.resStructure='';this.optNum=0;for(var i=0;i<this.realElement.children.length;i++){this.resStructure+=this.buildElement(this.realElement.children[i],i)+'\n';}
this.selectList.innerHTML=this.resStructure;},buildDropdownScroll:function(){if(this.options.dropMaxHeight){if(this.selectDrop.offsetHeight>this.options.dropMaxHeight){this.selectList.style.height=this.options.dropMaxHeight+'px';this.selectList.style.overflow='auto';this.selectList.style.overflowX='hidden';jcf.lib.addClass(this.selectDrop,this.options.dropScrollableClass);}}
jcf.lib.addClass(this.selectDrop,jcf.lib.getAllClasses(this.realElement.className,this.options.dropClassPrefix,jcf.baseOptions.hiddenClass));},parseOptionTitle:function(optTitle){return(typeof optTitle==='string'&&/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i.test(optTitle))?optTitle:'';},buildElement:function(obj,index){var res='',optImage;if(obj.tagName.toLowerCase()=='option'){if(!jcf.lib.prevSibling(obj)||jcf.lib.prevSibling(obj).tagName.toLowerCase()!='option'){res+='<ul>';}
optImage=this.parseOptionTitle(obj.title);res+='<li rel="'+(this.optNum++)+'" class="'+(obj.className?obj.className+' ':'')+(index%2?'option-even ':'')+'jcfcalc"><a href="#">'+(optImage?'<img src="'+optImage+'" alt="" />':'')+'<span>'+obj.innerHTML+'</span></a></li>';if(!jcf.lib.nextSibling(obj)||jcf.lib.nextSibling(obj).tagName.toLowerCase()!='option'){res+='</ul>';}
return res;}
else if(obj.tagName.toLowerCase()=='optgroup'&&obj.label){res+='<div class="'+this.options.optGroupClass+'">';res+='<strong class="jcfcalc"><em>'+(obj.label)+'</em></strong>';for(var i=0;i<obj.children.length;i++){res+=this.buildElement(obj.children[i],i);}
res+='</div>';return res;}},positionDropdown:function(){var ofs=jcf.lib.getOffset(this.fakeElement),selectAreaHeight=this.fakeElement.offsetHeight,selectDropHeight=this.selectDrop.offsetHeight;var fitInTop=ofs.top-selectDropHeight>=jcf.lib.getScrollTop()&&jcf.lib.getScrollTop()+jcf.lib.getWindowHeight()<ofs.top+selectAreaHeight+selectDropHeight;if((this.options.handleDropPosition&&fitInTop)||this.options.selectDropPosition==='top'){this.selectDrop.style.top=(ofs.top-selectDropHeight)+'px';jcf.lib.addClass(this.selectDrop,this.options.dropFlippedClass);}else{this.selectDrop.style.top=(ofs.top+selectAreaHeight)+'px';jcf.lib.removeClass(this.selectDrop,this.options.dropFlippedClass);}
this.selectDrop.style.left=ofs.left+'px';this.selectDrop.style.width=this.fakeElement.offsetWidth+'px';},showDropdown:function(){document.body.appendChild(this.selectDrop);jcf.lib.removeClass(this.selectDrop,this.options.dropHiddenClass);jcf.lib.addClass(this.fakeElement,this.options.dropActiveClass);this.positionDropdown();var activeItem=this.getFakeActiveOption();this.removeClassFromItems(this.options.currentSelectedClass);jcf.lib.addClass(activeItem,this.options.currentSelectedClass);jcf.lib.event.add(window,'resize',this.onResizeWindow,this);jcf.lib.event.add(window,'scroll',this.onScrollWindow,this);jcf.lib.event.add(document,jcf.eventPress,this.onClickOutside,this);this.positionDropdown();},hideDropdown:function(partial){if(this.selectDrop.parentNode){if(this.selectDrop.offsetWidth){this.selectDrop.parentNode.removeChild(this.selectDrop);}
if(partial){return;}}
if(typeof this.origSelectedIndex==='number'){this.realElement.selectedIndex=this.origSelectedIndex;}
jcf.lib.removeClass(this.fakeElement,this.options.dropActiveClass);jcf.lib.addClass(this.selectDrop,this.options.dropHiddenClass);jcf.lib.event.remove(window,'resize',this.onResizeWindow);jcf.lib.event.remove(window,'scroll',this.onScrollWindow);jcf.lib.event.remove(document.documentElement,jcf.eventPress,this.onClickOutside);if(jcf.isTouchDevice){this.onBlur();}},toggleDropdown:function(){if(!this.realElement.disabled){if(jcf.isTouchDevice){this.onFocus();}else{this.realElement.focus();}
if(this.isActiveDrop()){this.hideDropdown();}else{this.showDropdown();}
this.refreshState();}},scrollToItem:function(){if(this.isActiveDrop()){var dropHeight=this.selectList.offsetHeight;var offsetTop=this.calcOptionOffset(this.getFakeActiveOption());var sTop=this.selectList.scrollTop;var oHeight=this.getFakeActiveOption().offsetHeight;if(offsetTop>=sTop+dropHeight){this.selectList.scrollTop=offsetTop-dropHeight+oHeight;}else if(offsetTop<sTop){this.selectList.scrollTop=offsetTop;}}},getFakeActiveOption:function(c){return jcf.lib.queryBySelector('li[rel="'+(typeof c==='number'?c:this.realElement.selectedIndex)+'"]',this.selectList)[0];},calcOptionOffset:function(fake){var h=0;var els=jcf.lib.queryBySelector('.jcfcalc',this.selectList);for(var i=0;i<els.length;i++){if(els[i]==fake)break;h+=els[i].offsetHeight;}
return h;},childrenHasItem:function(hold,item){var items=hold.getElementsByTagName('*');for(i=0;i<items.length;i++){if(items[i]==item)return true;}
return false;},removeClassFromItems:function(className){var children=jcf.lib.queryBySelector('li',this.selectList);for(var i=children.length-1;i>=0;i--){jcf.lib.removeClass(children[i],className);}},setSelectedClass:function(c){jcf.lib.addClass(this.getFakeActiveOption(c),this.options.selectedClass);},refreshSelectedClass:function(c){if(!this.options.showNativeDrop){this.removeClassFromItems(this.options.selectedClass);this.setSelectedClass(c);}
if(this.realElement.disabled){jcf.lib.addClass(this.fakeElement,this.options.disabledClass);if(this.labelFor){jcf.lib.addClass(this.labelFor,this.options.labelDisabledClass);}}else{jcf.lib.removeClass(this.fakeElement,this.options.disabledClass);if(this.labelFor){jcf.lib.removeClass(this.labelFor,this.options.labelDisabledClass);}}},refreshSelectedText:function(){if(!this.dropOpened&&this.realElement.title){this.valueText.innerHTML=this.realElement.title;}else{if(this.realElement.options[this.realElement.selectedIndex].title){var optImage=this.parseOptionTitle(this.realElement.options[this.realElement.selectedIndex].title);this.valueText.innerHTML=(optImage?'<img src="'+optImage+'" alt="" />':'')+this.realElement.options[this.realElement.selectedIndex].innerHTML;}else{this.valueText.innerHTML=this.realElement.options[this.realElement.selectedIndex].innerHTML;}}},refreshState:function(){this.origSelectedIndex=this.realElement.selectedIndex;this.refreshSelectedClass();this.refreshSelectedText();if(!this.options.showNativeDrop){this.positionDropdown();if(this.selectDrop.offsetWidth){this.scrollToItem();}}}});BrowserDetect=(function(){var options={osVersion:false,minorBrowserVersion:false};var browserData={browsers:{chrome:uaMatch(/Chrome\/([0-9\.]*)/),firefox:uaMatch(/Firefox\/([0-9\.]*)/),safari:uaMatch(/Version\/([0-9\.]*).*Safari/),opera:uaMatch(/Opera\/.*Version\/([0-9\.]*)/,/Opera\/([0-9\.]*)/),msie:uaMatch(/MSIE ([0-9\.]*)/)},engines:{webkit:uaContains('AppleWebKit'),gecko:uaContains('Gecko'),presto:uaContains('Presto'),trident:uaContains('MSIE')},platforms:{win:uaMatch(/Windows NT ([0-9\.]*)/),mac:uaMatch(/Mac OS X ([0-9_\.]*)/),linux:uaContains('X11','Linux')}};var ua=navigator.userAgent;var detectData={platform:detectItem(browserData.platforms),browser:detectItem(browserData.browsers),engine:detectItem(browserData.engines)};function uaMatch(regExp,altReg){return function(){var result=regExp.exec(ua)||altReg&&altReg.exec(ua);return result&&result[1];};}
function uaContains(word){var args=Array.prototype.slice.apply(arguments);return function(){for(var i=0;i<args.length;i++){if(ua.indexOf(args[i])<0){return;}}
return true;};}
function detectItem(items){var detectedItem=null,itemName,detectValue;for(itemName in items){if(items.hasOwnProperty(itemName)){detectValue=items[itemName]();if(detectValue){return{name:itemName,value:detectValue};}}}}
(function(){var addClass=function(cls){var html=document.documentElement;html.className+=(html.className?' ':'')+cls;};var getVersion=function(ver){return ver.replace(/\./g,'_');};if(detectData.platform){addClass(detectData.platform.name);if(options.osVersion){addClass(detectData.platform.name+'-'+getVersion(detectData.platform.value));}}
if(detectData.engine){addClass(detectData.engine.name);}
if(detectData.browser){addClass(detectData.browser.name);addClass(detectData.browser.name+'-'+parseInt(detectData.browser.value,10));if(options.minorBrowserVersion){addClass(detectData.browser.name+'-'+getVersion(detectData.browser.value));}}}());return detectData;}());PlatformDetect=(function(){var detectModules={};return{options:{cssPath:'css/'},addModule:function(obj){detectModules[obj.type]=obj;},addRule:function(rule){if(this.matchRule(rule)){this.applyRule(rule);return true;}},matchRule:function(rule){return detectModules[rule.type].matchRule(rule);},applyRule:function(rule){var head=document.getElementsByTagName('head')[0],fragment,cssText;if(rule.css){cssText='<link rel="stylesheet" href="'+this.options.cssPath+rule.css+'" />';if(head){fragment=document.createElement('div');fragment.innerHTML=cssText;head.appendChild(fragment.childNodes[0]);}else{document.write(cssText);}}
if(rule.meta){if(head){fragment=document.createElement('div');fragment.innerHTML=rule.meta;head.appendChild(fragment.childNodes[0]);}else{document.write(rule.meta);}}},matchVersions:function(host,target){target=target.toString();host=host.toString();var majorVersionMatch=parseInt(target,10)===parseInt(host,10);var minorVersionMatch=(host.length>target.length?host.indexOf(target):target.indexOf(host))===0;return majorVersionMatch&&minorVersionMatch;}};}());PlatformDetect.addModule({type:'allmobile',uaMatch:function(str){if(!this.ua){this.ua=navigator.userAgent.toLowerCase();}
return this.ua.indexOf(str.toLowerCase())!=-1;},matchRule:function(rule){return this.uaMatch('mobi')||this.uaMatch('midp')||this.uaMatch('ppc')||this.uaMatch('webos')||this.uaMatch('android')||this.uaMatch('phone os')||this.uaMatch('touch');}});PlatformDetect.addModule({type:'iphone',parseUserAgent:function(){var match=/(iPhone|iPod).*OS ([0-9_]*) .*/.exec(navigator.userAgent);if(match){return{retina:window.devicePixelRatio>1,version:match[2].replace(/_/g,'.')};}},matchRule:function(rule){this.matchData=this.matchData||this.parseUserAgent();if(this.matchData){var matchVersion=rule.version?PlatformDetect.matchVersions(this.matchData.version,rule.version):true;var matchDevice=rule.deviceType?(rule.deviceType==='retina'&&this.matchData.retina)||(rule.deviceType==='noretina'&&!this.matchData.retina):true;return matchVersion&&matchDevice;}}});PlatformDetect.addModule({type:'ipad',parseUserAgent:function(){var match=/(iPad).*OS ([0-9_]*) .*/.exec(navigator.userAgent);if(match){return{retina:window.devicePixelRatio>1,version:match[2].replace(/_/g,'.')};}},matchRule:function(rule){this.matchData=this.matchData||this.parseUserAgent();if(this.matchData){var matchVersion=rule.version?PlatformDetect.matchVersions(this.matchData.version,rule.version):true;var matchDevice=rule.deviceType?(rule.deviceType==='retina'&&this.matchData.retina)||(rule.deviceType==='noretina'&&!this.matchData.retina):true;return matchVersion&&matchDevice;}}});PlatformDetect.addModule({type:'android',parseUserAgent:function(){var match=/(Android) ([0-9.]*).*/.exec(navigator.userAgent);if(match){return{deviceType:navigator.userAgent.indexOf('Mobile')>0?'mobile':'tablet',version:match[2]};}},matchRule:function(rule){this.matchData=this.matchData||this.parseUserAgent();if(this.matchData){var matchVersion=rule.version?PlatformDetect.matchVersions(this.matchData.version,rule.version):true;var matchDevice=rule.deviceType?rule.deviceType===this.matchData.deviceType:true;return matchVersion&&matchDevice;}}});PlatformDetect.addModule({type:'blackberry',parseUserAgent:function(){var match=/(BlackBerry).*Version\/([0-9.]*).*/.exec(navigator.userAgent);if(match){return{version:match[2]};}},matchRule:function(rule){this.matchData=this.matchData||this.parseUserAgent();if(this.matchData){return rule.version?PlatformDetect.matchVersions(this.matchData.version,rule.version):true;}}});PlatformDetect.addRule({type:'allmobile',css:'allmobile.css'});PlatformDetect.addRule({type:'iphone',css:'iphone.css',meta:'<meta name="viewport" content="width=device-width" />'});PlatformDetect.addRule({type:'ipad',css:'ipad.css',meta:'<meta name="viewport" content="width=device-width" />'});PlatformDetect.addRule({type:'android',version:4,css:'android.css'});PlatformDetect.addRule({type:'android',version:4.2,css:'android4x.css'});PlatformDetect.addRule({type:'android',version:2,css:'android2x.css'});PlatformDetect.addRule({type:'blackberry',css:'blackberry.css'});;(function(){var placeholderCollection=[];PlaceholderInput=function(){this.options={element:null,showUntilTyping:false,wrapWithElement:false,getParentByClass:false,showPasswordBullets:false,placeholderAttr:'value',inputFocusClass:'focus',inputActiveClass:'text-active',parentFocusClass:'parent-focus',parentActiveClass:'parent-active',labelFocusClass:'label-focus',labelActiveClass:'label-active',fakeElementClass:'input-placeholder-text'};placeholderCollection.push(this);this.init.apply(this,arguments);};PlaceholderInput.refreshAllInputs=function(except){for(var i=0;i<placeholderCollection.length;i++){if(except!==placeholderCollection[i]){placeholderCollection[i].refreshState();}}};PlaceholderInput.replaceByOptions=function(opt){var inputs=[].concat(convertToArray(document.getElementsByTagName('input')),convertToArray(document.getElementsByTagName('textarea')));for(var i=0;i<inputs.length;i++){if(inputs[i].className.indexOf(opt.skipClass)<0){var inputType=getInputType(inputs[i]);var placeholderValue=inputs[i].getAttribute('placeholder');if(opt.focusOnly||(opt.clearInputs&&(inputType==='text'||inputType==='email'||placeholderValue))||(opt.clearTextareas&&inputType==='textarea')||(opt.clearPasswords&&inputType==='password')){new PlaceholderInput({element:inputs[i],focusOnly:opt.focusOnly,wrapWithElement:opt.wrapWithElement,showUntilTyping:opt.showUntilTyping,getParentByClass:opt.getParentByClass,showPasswordBullets:opt.showPasswordBullets,placeholderAttr:placeholderValue?'placeholder':opt.placeholderAttr});}}}};PlaceholderInput.prototype={init:function(opt){this.setOptions(opt);if(this.element&&this.element.PlaceholderInst){this.element.PlaceholderInst.refreshClasses();}else{this.element.PlaceholderInst=this;if(this.elementType!=='radio'||this.elementType!=='checkbox'||this.elementType!=='file'){this.initElements();this.attachEvents();this.refreshClasses();}}},setOptions:function(opt){for(var p in opt){if(opt.hasOwnProperty(p)){this.options[p]=opt[p];}}
if(this.options.element){this.element=this.options.element;this.elementType=getInputType(this.element);if(this.options.focusOnly){this.wrapWithElement=false;}else{if(this.elementType==='password'&&this.options.showPasswordBullets){this.wrapWithElement=false;}else{this.wrapWithElement=this.elementType==='password'||this.options.showUntilTyping?true:this.options.wrapWithElement;}}
this.setPlaceholderValue(this.options.placeholderAttr);}},setPlaceholderValue:function(attr){this.origValue=(attr==='value'?this.element.defaultValue:(this.element.getAttribute(attr)||''));if(this.options.placeholderAttr!=='value'){this.element.removeAttribute(this.options.placeholderAttr);}},initElements:function(){if(this.wrapWithElement){this.fakeElement=document.createElement('span');this.fakeElement.className=this.options.fakeElementClass;this.fakeElement.innerHTML+=this.origValue;this.fakeElement.style.color=getStyle(this.element,'color');this.fakeElement.style.position='absolute';this.element.parentNode.insertBefore(this.fakeElement,this.element);if(this.element.value===this.origValue||!this.element.value){this.element.value='';this.togglePlaceholderText(true);}else{this.togglePlaceholderText(false);}}else if(!this.element.value&&this.origValue.length){this.element.value=this.origValue;}
if(this.element.id){this.labels=document.getElementsByTagName('label');for(var i=0;i<this.labels.length;i++){if(this.labels[i].htmlFor===this.element.id){this.labelFor=this.labels[i];break;}}}
this.elementParent=this.element.parentNode;if(typeof this.options.getParentByClass==='string'){var el=this.element;while(el.parentNode){if(hasClass(el.parentNode,this.options.getParentByClass)){this.elementParent=el.parentNode;break;}else{el=el.parentNode;}}}},attachEvents:function(){this.element.onfocus=bindScope(this.focusHandler,this);this.element.onblur=bindScope(this.blurHandler,this);if(this.options.showUntilTyping){this.element.onkeydown=bindScope(this.typingHandler,this);this.element.onpaste=bindScope(this.typingHandler,this);}
if(this.wrapWithElement)this.fakeElement.onclick=bindScope(this.focusSetter,this);},togglePlaceholderText:function(state){if(!this.element.readOnly&&!this.options.focusOnly){if(this.wrapWithElement){this.fakeElement.style.display=state?'':'none';}else{this.element.value=state?this.origValue:'';}}},focusSetter:function(){this.element.focus();},focusHandler:function(){clearInterval(this.checkerInterval);this.checkerInterval=setInterval(bindScope(this.intervalHandler,this),1);this.focused=true;if(!this.element.value.length||this.element.value===this.origValue){if(!this.options.showUntilTyping){this.togglePlaceholderText(false);}}
this.refreshClasses();},blurHandler:function(){clearInterval(this.checkerInterval);this.focused=false;if(!this.element.value.length||this.element.value===this.origValue){this.togglePlaceholderText(true);}
this.refreshClasses();PlaceholderInput.refreshAllInputs(this);},typingHandler:function(){setTimeout(bindScope(function(){if(this.element.value.length){this.togglePlaceholderText(false);this.refreshClasses();}},this),10);},intervalHandler:function(){if(typeof this.tmpValue==='undefined'){this.tmpValue=this.element.value;}
if(this.tmpValue!=this.element.value){PlaceholderInput.refreshAllInputs(this);}},refreshState:function(){if(this.wrapWithElement){if(this.element.value.length&&this.element.value!==this.origValue){this.togglePlaceholderText(false);}else if(!this.element.value.length){this.togglePlaceholderText(true);}}
this.refreshClasses();},refreshClasses:function(){this.textActive=this.focused||(this.element.value.length&&this.element.value!==this.origValue);this.setStateClass(this.element,this.options.inputFocusClass,this.focused);this.setStateClass(this.elementParent,this.options.parentFocusClass,this.focused);this.setStateClass(this.labelFor,this.options.labelFocusClass,this.focused);this.setStateClass(this.element,this.options.inputActiveClass,this.textActive);this.setStateClass(this.elementParent,this.options.parentActiveClass,this.textActive);this.setStateClass(this.labelFor,this.options.labelActiveClass,this.textActive);},setStateClass:function(el,cls,state){if(!el)return;else if(state)addClass(el,cls);else removeClass(el,cls);}};function convertToArray(collection){var arr=[];for(var i=0,ref=arr.length=collection.length;i<ref;i++){arr[i]=collection[i];}
return arr;}
function getInputType(input){return(input.type?input.type:input.tagName).toLowerCase();}
function hasClass(el,cls){return el.className?el.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)')):false;}
function addClass(el,cls){if(!hasClass(el,cls))el.className+=" "+cls;}
function removeClass(el,cls){if(hasClass(el,cls)){el.className=el.className.replace(new RegExp('(\\s|^)'+cls+'(\\s|$)'),' ');}}
function bindScope(f,scope){return function(){return f.apply(scope,arguments);};}
function getStyle(el,prop){if(document.defaultView&&document.defaultView.getComputedStyle){return document.defaultView.getComputedStyle(el,null)[prop];}else if(el.currentStyle){return el.currentStyle[prop];}else{return el.style[prop];}}}());function TouchNav(opt){this.options={hoverClass:'hover',menuItems:'li',menuOpener:'a',menuDrop:'ul',navBlock:null};for(var p in opt){if(opt.hasOwnProperty(p)){this.options[p]=opt[p];}}
this.init();}
TouchNav.isActiveOn=function(elem){return elem&&elem.touchNavActive;};TouchNav.prototype={init:function(){if(typeof this.options.navBlock==='string'){this.menu=document.getElementById(this.options.navBlock);}else if(typeof this.options.navBlock==='object'){this.menu=this.options.navBlock;}
if(this.menu){this.addEvents();}},addEvents:function(){var self=this;this.menuItems=lib.queryElementsBySelector(this.options.menuItems,this.menu);for(var i=0;i<this.menuItems.length;i++){(function(i){var item=self.menuItems[i],currentDrop=lib.queryElementsBySelector(self.options.menuDrop,item)[0],currentOpener=lib.queryElementsBySelector(self.options.menuOpener,item)[0];if((self.isTouchDevice||navigator.msPointerEnabled)&&currentDrop&&currentOpener){lib.event.add(currentOpener,'click',lib.bind(self.clickHandler,self));lib.event.add(currentOpener,navigator.msPointerEnabled?'MSPointerDown':'touchstart',function(e){if(navigator.msPointerEnabled&&e.pointerType!==e.MSPOINTER_TYPE_TOUCH)return;self.touchFlag=true;self.currentItem=item;self.currentLink=currentOpener;self.pressHandler.apply(self,arguments);});}
lib.event.add(item,'mouseover',function(){if(!self.touchFlag){self.currentItem=item;self.mouseoverHandler();}});lib.event.add(item,'mouseout',function(){if(!self.touchFlag){self.currentItem=item;self.mouseoutHandler();}});item.touchNavActive=true;})(i);}
if(this.isTouchDevice||navigator.msPointerEnabled){lib.event.add(document,navigator.msPointerEnabled?'MSPointerDown':'touchstart',lib.bind(this.clickOutsideHandler,this));}},mouseoverHandler:function(){lib.addClass(this.currentItem,this.options.hoverClass);jQuery(this.currentItem).trigger('itemhover');},mouseoutHandler:function(){lib.removeClass(this.currentItem,this.options.hoverClass);jQuery(this.currentItem).trigger('itemleave');},hideActiveDropdown:function(){for(var i=0;i<this.menuItems.length;i++){if(lib.hasClass(this.menuItems[i],this.options.hoverClass)){lib.removeClass(this.menuItems[i],this.options.hoverClass);jQuery(this.menuItems[i]).trigger('itemleave');}}
this.activeParent=null;},pressHandler:function(e){if(this.currentItem!=this.activeParent&&!this.isParent(this.activeParent,this.currentLink)){this.hideActiveDropdown();}
this.activeParent=this.currentItem;if(lib.hasClass(this.currentItem,this.options.hoverClass)){this.preventCurrentClick=false;}else{e.preventDefault();this.preventCurrentClick=true;lib.addClass(this.currentItem,this.options.hoverClass);jQuery(this.currentItem).trigger('itemhover');}},clickHandler:function(e){if(this.preventCurrentClick){e.preventDefault();}},clickOutsideHandler:function(event){if(navigator.msPointerEnabled&&event.pointerType!==event.MSPOINTER_TYPE_TOUCH)return;var e=event.changedTouches?event.changedTouches[0]:event;if(this.activeParent&&!this.isParent(this.menu,e.target)){this.hideActiveDropdown();this.touchFlag=false;}},isParent:function(parent,child){while(child.parentNode){if(child.parentNode==parent){return true;}
child=child.parentNode;}
return false;},isTouchDevice:(function(){try{return(('ontouchstart'in window)||window.DocumentTouch&&document instanceof DocumentTouch)||navigator.userAgent.indexOf('IEMobile')!=-1;}catch(e){return false;}}())};lib={hasClass:function(el,cls){return el&&el.className?el.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)')):false;},addClass:function(el,cls){if(el&&!this.hasClass(el,cls))el.className+=" "+cls;},removeClass:function(el,cls){if(el&&this.hasClass(el,cls)){el.className=el.className.replace(new RegExp('(\\s|^)'+cls+'(\\s|$)'),' ');}},extend:function(obj){for(var i=1;i<arguments.length;i++){for(var p in arguments[i]){if(arguments[i].hasOwnProperty(p)){obj[p]=arguments[i][p];}}}
return obj;},each:function(obj,callback){var property,len;if(typeof obj.length==='number'){for(property=0,len=obj.length;property<len;property++){if(callback.call(obj[property],property,obj[property])===false){break;}}}else{for(property in obj){if(obj.hasOwnProperty(property)){if(callback.call(obj[property],property,obj[property])===false){break;}}}}},event:(function(){var fixEvent=function(e){e=e||window.event;if(e.isFixed)return e;else e.isFixed=true;if(!e.target)e.target=e.srcElement;e.preventDefault=e.preventDefault||function(){this.returnValue=false;};e.stopPropagation=e.stopPropagation||function(){this.cancelBubble=true;};return e;};return{add:function(elem,event,handler){if(!elem.events){elem.events={};elem.handle=function(e){var ret,handlers=elem.events[e.type];e=fixEvent(e);for(var i=0,len=handlers.length;i<len;i++){if(handlers[i]){ret=handlers[i].call(elem,e);if(ret===false){e.preventDefault();e.stopPropagation();}}}};}
if(!elem.events[event]){elem.events[event]=[];if(elem.addEventListener)elem.addEventListener(event,elem.handle,false);else if(elem.attachEvent)elem.attachEvent('on'+event,elem.handle);}
elem.events[event].push(handler);},remove:function(elem,event,handler){var handlers=elem.events[event];for(var i=handlers.length-1;i>=0;i--){if(handlers[i]===handler){handlers.splice(i,1);}}
if(!handlers.length){delete elem.events[event];if(elem.removeEventListener)elem.removeEventListener(event,elem.handle,false);else if(elem.detachEvent)elem.detachEvent('on'+event,elem.handle);}}};}()),queryElementsBySelector:function(selector,scope){scope=scope||document;if(!selector)return[];if(selector==='>*')return scope.children;if(typeof document.querySelectorAll==='function'){return scope.querySelectorAll(selector);}
var selectors=selector.split(',');var resultList=[];for(var s=0;s<selectors.length;s++){var currentContext=[scope||document];var tokens=selectors[s].replace(/^\s+/,'').replace(/\s+$/,'').split(' ');for(var i=0;i<tokens.length;i++){token=tokens[i].replace(/^\s+/,'').replace(/\s+$/,'');if(token.indexOf('#')>-1){var bits=token.split('#'),tagName=bits[0],id=bits[1];var element=document.getElementById(id);if(element&&tagName&&element.nodeName.toLowerCase()!=tagName){return[];}
currentContext=element?[element]:[];continue;}
if(token.indexOf('.')>-1){var bits=token.split('.'),tagName=bits[0]||'*',className=bits[1],found=[],foundCount=0;for(var h=0;h<currentContext.length;h++){var elements;if(tagName=='*'){elements=currentContext[h].getElementsByTagName('*');}else{elements=currentContext[h].getElementsByTagName(tagName);}
for(var j=0;j<elements.length;j++){found[foundCount++]=elements[j];}}
currentContext=[];var currentContextIndex=0;for(var k=0;k<found.length;k++){if(found[k].className&&found[k].className.match(new RegExp('(\\s|^)'+className+'(\\s|$)'))){currentContext[currentContextIndex++]=found[k];}}
continue;}
if(token.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){var tagName=RegExp.$1||'*',attrName=RegExp.$2,attrOperator=RegExp.$3,attrValue=RegExp.$4;if(attrName.toLowerCase()=='for'&&this.browser.msie&&this.browser.version<8){attrName='htmlFor';}
var found=[],foundCount=0;for(var h=0;h<currentContext.length;h++){var elements;if(tagName=='*'){elements=currentContext[h].getElementsByTagName('*');}else{elements=currentContext[h].getElementsByTagName(tagName);}
for(var j=0;elements[j];j++){found[foundCount++]=elements[j];}}
currentContext=[];var currentContextIndex=0,checkFunction;switch(attrOperator){case '=':checkFunction=function(e){return(e.getAttribute(attrName)==attrValue)};break;case '~':checkFunction=function(e){return(e.getAttribute(attrName).match(new RegExp('(\\s|^)'+attrValue+'(\\s|$)')))};break;case '|':checkFunction=function(e){return(e.getAttribute(attrName).match(new RegExp('^'+attrValue+'-?')))};break;case '^':checkFunction=function(e){return(e.getAttribute(attrName).indexOf(attrValue)==0)};break;case '$':checkFunction=function(e){return(e.getAttribute(attrName).lastIndexOf(attrValue)==e.getAttribute(attrName).length-attrValue.length)};break;case '*':checkFunction=function(e){return(e.getAttribute(attrName).indexOf(attrValue)>-1)};break;default:checkFunction=function(e){return e.getAttribute(attrName)};}
currentContext=[];var currentContextIndex=0;for(var k=0;k<found.length;k++){if(checkFunction(found[k])){currentContext[currentContextIndex++]=found[k];}}
continue;}
tagName=token;var found=[],foundCount=0;for(var h=0;h<currentContext.length;h++){var elements=currentContext[h].getElementsByTagName(tagName);for(var j=0;j<elements.length;j++){found[foundCount++]=elements[j];}}
currentContext=found;}
resultList=[].concat(resultList,currentContext);}
return resultList;},trim:function(str){return str.replace(/^\s+/,'').replace(/\s+$/,'');},bind:function(f,scope,forceArgs){return function(){return f.apply(scope,typeof forceArgs!=='undefined'?[forceArgs]:arguments);};}};function initLightbox(){jQuery('a.lightbox, a[data-rel*="lightbox"]').each(function(){var link=jQuery(this);link.attr('rel',link.attr('data-rel'));});jQuery('a.lightbox, a[data-rel*="lightbox"]').fancybox({padding:10,cyclic:false,overlayShow:true,overlayOpacity:0.65,overlayColor:'#000000',titlePosition:'inside',onComplete:function(box){if(link.attr('href').indexOf('#')===0){jQuery('#fancybox-content').find('a.close').unbind('click.fb').bind('click.fb',function(e){jQuery.fancybox.close();e.preventDefault();});}}});}
jQuery(function(){var isTouchDevice=(function(){try{return('ontouchstart'in window)||window.DocumentTouch&&document instanceof DocumentTouch;}catch(e){return false;}}());var supportPositionFixed=!((jQuery.browser.msie&&jQuery.browser.version<8)||isTouchDevice);var overlaySelector='#fancybox-overlay';if(supportPositionFixed){var head=document.getElementsByTagName('head')[0],style=document.createElement('style'),rules=document.createTextNode(overlaySelector+'{'+
'position:fixed;'+
'top:0;'+
'left:0;'+
'}');style.type='text/css';if(style.styleSheet){style.styleSheet.cssText=rules.nodeValue;}else{style.appendChild(rules);}
head.appendChild(style);}});